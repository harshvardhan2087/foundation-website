{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 46, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Downloads/foundation-website/lib/admin-auth.ts"],"sourcesContent":["\"use server\"\r\n\r\nimport { cookies } from \"next/headers\"\r\nimport { SignJWT, jwtVerify } from \"jose\"\r\n\r\nconst SECRET_KEY = new TextEncoder().encode(process.env.JWT_SECRET || \"your-secret-key-change-in-production\")\r\n\r\nconst ADMIN_USERNAME = process.env.ADMIN_USERNAME || \"admin\"\r\nconst ADMIN_PASSWORD = process.env.ADMIN_PASSWORD || \"admin123\"\r\n\r\nexport interface AdminSession {\r\n  username: string\r\n  isAdmin: boolean\r\n  exp: number\r\n}\r\n\r\nexport async function verifyAdminCredentials(username: string, password: string): Promise<boolean> {\r\n  return username === ADMIN_USERNAME && password === ADMIN_PASSWORD\r\n}\r\n\r\nexport async function createAdminSession(username: string): Promise<string> {\r\n  const token = await new SignJWT({ username, isAdmin: true })\r\n    .setProtectedHeader({ alg: \"HS256\" })\r\n    .setExpirationTime(\"7d\")\r\n    .sign(SECRET_KEY)\r\n\r\n  const cookieStore = await cookies()\r\n  cookieStore.set(\"admin-session\", token, {\r\n    httpOnly: true,\r\n    secure: process.env.NODE_ENV === \"production\",\r\n    sameSite: \"lax\",\r\n    maxAge: 60 * 60 * 24 * 7, // 7 days\r\n    path: \"/\",\r\n  })\r\n\r\n  return token\r\n}\r\n\r\nexport async function getAdminSession(): Promise<AdminSession | null> {\r\n  try {\r\n    const cookieStore = await cookies()\r\n    const token = cookieStore.get(\"admin-session\")\r\n\r\n    if (!token) {\r\n      return null\r\n    }\r\n\r\n    const verified = await jwtVerify(token.value, SECRET_KEY)\r\n    return verified.payload as AdminSession\r\n  } catch (error) {\r\n    console.error(\"[v0] Error verifying admin session:\", error)\r\n    return null\r\n  }\r\n}\r\n\r\nexport async function clearAdminSession(): Promise<void> {\r\n  const cookieStore = await cookies()\r\n  cookieStore.delete(\"admin-session\")\r\n}\r\n\r\nexport async function isAuthenticated(): Promise<boolean> {\r\n  const session = await getAdminSession()\r\n  return session !== null && session.isAdmin === true\r\n}\r\n"],"names":[],"mappings":";;;;;;;;;;;;;AAEA;AACA;AAAA;;;;;AAEA,MAAM,aAAa,IAAI,cAAc,MAAM,CAAC,QAAQ,GAAG,CAAC,UAAU,IAAI;AAEtE,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AACrD,MAAM,iBAAiB,QAAQ,GAAG,CAAC,cAAc,IAAI;AAQ9C,eAAe,uBAAuB,QAAgB,EAAE,QAAgB;IAC7E,OAAO,aAAa,kBAAkB,aAAa;AACrD;AAEO,eAAe,mBAAmB,QAAgB;IACvD,MAAM,QAAQ,MAAM,IAAI,kKAAO,CAAC;QAAE;QAAU,SAAS;IAAK,GACvD,kBAAkB,CAAC;QAAE,KAAK;IAAQ,GAClC,iBAAiB,CAAC,MAClB,IAAI,CAAC;IAER,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,GAAG,CAAC,iBAAiB,OAAO;QACtC,UAAU;QACV,QAAQ,oDAAyB;QACjC,UAAU;QACV,QAAQ,KAAK,KAAK,KAAK;QACvB,MAAM;IACR;IAEA,OAAO;AACT;AAEO,eAAe;IACpB,IAAI;QACF,MAAM,cAAc,MAAM,IAAA,4IAAO;QACjC,MAAM,QAAQ,YAAY,GAAG,CAAC;QAE9B,IAAI,CAAC,OAAO;YACV,OAAO;QACT;QAEA,MAAM,WAAW,MAAM,IAAA,sKAAS,EAAC,MAAM,KAAK,EAAE;QAC9C,OAAO,SAAS,OAAO;IACzB,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,uCAAuC;QACrD,OAAO;IACT;AACF;AAEO,eAAe;IACpB,MAAM,cAAc,MAAM,IAAA,4IAAO;IACjC,YAAY,MAAM,CAAC;AACrB;AAEO,eAAe;IACpB,MAAM,UAAU,MAAM;IACtB,OAAO,YAAY,QAAQ,QAAQ,OAAO,KAAK;AACjD;;;IA/CsB;IAIA;IAkBA;IAiBA;IAKA;;AA5CA,iPAAA;AAIA,iPAAA;AAkBA,iPAAA;AAiBA,iPAAA;AAKA,iPAAA"}},
    {"offset": {"line": 128, "column": 0}, "map": {"version":3,"sources":["file:///C:/Users/Lenovo/Downloads/foundation-website/app/api/admin/login/route.ts"],"sourcesContent":["import { type NextRequest, NextResponse } from \"next/server\"\r\nimport { verifyAdminCredentials, createAdminSession } from \"@/lib/admin-auth\"\r\n\r\nexport async function POST(request: NextRequest) {\r\n  try {\r\n    const { username, password } = await request.json()\r\n\r\n    if (!username || !password) {\r\n      return NextResponse.json({ message: \"Username and password are required\" }, { status: 400 })\r\n    }\r\n\r\n    const isValid = await verifyAdminCredentials(username, password)\r\n\r\n    if (!isValid) {\r\n      return NextResponse.json({ message: \"Invalid credentials\" }, { status: 401 })\r\n    }\r\n\r\n    await createAdminSession(username)\r\n\r\n    return NextResponse.json({ message: \"Login successful\" }, { status: 200 })\r\n  } catch (error) {\r\n    console.error(\"[v0] Login error:\", error)\r\n    return NextResponse.json({ message: \"An error occurred\" }, { status: 500 })\r\n  }\r\n}\r\n"],"names":[],"mappings":";;;;AAAA;AACA;;;AAEO,eAAe,KAAK,OAAoB;IAC7C,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,QAAQ,EAAE,GAAG,MAAM,QAAQ,IAAI;QAEjD,IAAI,CAAC,YAAY,CAAC,UAAU;YAC1B,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAqC,GAAG;gBAAE,QAAQ;YAAI;QAC5F;QAEA,MAAM,UAAU,MAAM,IAAA,gJAAsB,EAAC,UAAU;QAEvD,IAAI,CAAC,SAAS;YACZ,OAAO,gJAAY,CAAC,IAAI,CAAC;gBAAE,SAAS;YAAsB,GAAG;gBAAE,QAAQ;YAAI;QAC7E;QAEA,MAAM,IAAA,4IAAkB,EAAC;QAEzB,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAmB,GAAG;YAAE,QAAQ;QAAI;IAC1E,EAAE,OAAO,OAAO;QACd,QAAQ,KAAK,CAAC,qBAAqB;QACnC,OAAO,gJAAY,CAAC,IAAI,CAAC;YAAE,SAAS;QAAoB,GAAG;YAAE,QAAQ;QAAI;IAC3E;AACF"}}]
}